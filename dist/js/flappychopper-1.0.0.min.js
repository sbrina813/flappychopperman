$(function(){function a(){setTimeout(function(){setInterval(function(){1===j&&g()},1300)},2050)}function b(){(1===j||2===j)&&($chopper.css("transform","rotate(-20deg)"),$chopper.stop().animate({bottom:"+=60px"},200,function(){d(),$chopper.css("transform","rotate(0deg)"),$chopper.stop().animate({bottom:"-=60px"},300,"linear",function(){d(),c()})}))}function c(){percent=parseInt($chopper.css("bottom"))/$screen.height(),totalFallTime=i*percent,$chopper.stop().animate({bottom:"0"},totalFallTime,"linear"),$chopper.css("transform","rotate(90deg)")}function d(){(0===parseInt($chopper.css("bottom"))||0===parseInt($chopper.css("top")))&&h(),currentPipe=$(".pipe:nth-of-type(4)"),currentPipe.length&&(pipeTop=$(".pipe:nth-of-type(4) .topHalf"),pipeBottom=$(".pipe:nth-of-type(4) .bottomHalf"),$chopper.offset().left+$chopper.width()>=currentPipe.offset().left&&$chopper.offset().left<=currentPipe.offset().left+60?($chopper.offset().top<currentPipe.offset().top+pipeTop.height()||$chopper.offset().top+$chopper.height()>currentPipe.offset().top+pipeTop.height()+k)&&h():$chopper.offset().left>=currentPipe.offset().left+60&&$(".score").text(currentPipe.attr("pipe-id")))}function e(){l++,topHeight=Math.floor(150*Math.random())+150,bottomHeight=$screen.height()-(topHeight+k),pipe='<div class="pipe" pipe-id="'+l+'"><div style="height: '+topHeight+'px" class="topHalf"></div> <div style="height:'+bottomHeight+'px" class="bottomHalf"></div></div>',$screen.append(pipe)}function f(){$(".pipe").each(function(){$(this).animate({right:"+=160px"},1300,"linear")})}function g(){$(".pipe").first().remove()}function h(){clearInterval(m),$(".pipe").stop(),c(),j=0}$screen=$(".playScreen"),$chopper=$(".chopper");var i=1500,j=2,k=150,l=0,m=(setInterval(function(){1===j&&(e(),f())},1300),setInterval(function(){1===j&&d()},10));$screen.mousedown(function(){b(),2===j&&(j=1,a())}),$(window).keydown(function(c){32===c.keyCode&&(b(),c.preventDefault(),2===j&&(j=1,a()))})});